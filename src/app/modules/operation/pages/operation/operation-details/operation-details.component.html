<ng-container *ngIf="operation$ | async as operation; else loading">
  <div class="p-8 bg-dark">
    <div class="flex justify-between">
      <app-close-button
        *ngIf="extended"
        (closeEvent)="goBack()"></app-close-button>
      <div
        *ngIf="extended"
        class="flex flex-row items-center space-x-5">
        <app-rounded-button
          text="Edit"
          bgColor="bg-orange"
          type="submit"
          (clickEvent)="goToEdit(operation.id)">
        </app-rounded-button>

        <app-rounded-button
          text="Delete"
          bgColor="bg-red"
          type="submit"
          (clickEvent)="onDeleteOperation(operation.id)"></app-rounded-button>
      </div>
    </div>
  </div>

  <div class="p-8">
    <p class="text-white font-semibold">OPERATION DETAILS</p>
    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Symbol"></app-form-label>
      <div class="pl-10">
        <app-label [text]="operation.symbol.name_sym"></app-label>
      </div>
    </div>

    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Order type"></app-form-label>
      <div class="pl-[17px]">
        <app-label [text]="operation.updown ? 'LONG' : 'SHORT'"></app-label>

      </div>
    </div>

    <div
      *ngIf="operation.dateOpen"
      class="flex flex-row items-center pt-5">
      <app-form-label text="Opened"></app-form-label>
      <div class="pl-[35px]">
        <app-label [text]="(operation.dateOpen | date: 'yyyy-MM-dd')!"></app-label>
      </div>
    </div>

    <div
      *ngIf="operation.dateClose"
      class="flex flex-row items-center pt-5">
      <app-form-label text="Close"></app-form-label>
      <div class="pl-[53px]">
        <app-label [text]="(operation.dateClose | date: 'yyyy-MM-dd')!"></app-label>
      </div>
    </div>

    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Timeframe"></app-form-label>
      <div class="pl-4">
        <app-label [text]="operation.timeframe"></app-label>
      </div>
    </div>

    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Account"></app-form-label>
      <div class="pl-[35px]">
        <app-label [text]="operation.account.account_type"></app-label>
      </div>
    </div>

    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Status"></app-form-label>
      <div class="pl-[50px]">
        <app-label [text]="operation.status.name_st"></app-label>
      </div>
    </div>

    <div
      *ngIf="operation.volume"
      class="flex flex-row items-center pt-5">
      <app-form-label text="Volume"></app-form-label>
      <div class="pl-[40px]">
        <app-label [text]="operation.volume.toString()"></app-label>
      </div>
    </div>

    <div
      *ngIf="operation.ratio"
      class="flex flex-row items-center pt-5">
      <app-form-label text="Ratio"></app-form-label>
      <div class="pl-[55px]">
        <app-label [text]="operation.ratio.toString()"></app-label>
      </div>
    </div>

    <div
      *ngIf="operation.points"
      class="flex flex-row items-center pt-5">
      <app-form-label text="Points"></app-form-label>
      <div class="pl-[50px]">
        <app-label
          [text]="operation.points.toString()"
          [textColor]="getPointsColorClass(operation.points)"></app-label>
      </div>
    </div>

    <div class="flex flex-row items-center pt-5">
      <app-form-label text="Comment"></app-form-label>
      <div class="pl-7">
        <ng-container *ngIf="comment$ | async as comment;">
          <textarea
            cols="30"
            rows="5"
            class="rounded"
            readonly>
            {{comment.opcomment}}
          </textarea>
        </ng-container>
      </div>
    </div>

    <div
      *ngIf="extended && operation.graph"
      class="flex items-center flex-row pt-10">
      <button
        type="button"
        (click)="goToChart(operation)">
        <label class="flex flex-row bg-blue-turquoise rounded text-white items-center font-semibold p-3">
          <svg-icon
            [svgStyle]="{'height.px': 32, 'width.px': 32}"
            src="assets/svg/graphics.svg"></svg-icon>
          <div class="pl-2">
            <h5 class="text-center">View chart</h5>
          </div>
        </label>
      </button>
    </div>
  </div>
</ng-container>

<ng-template #loading>
  <app-loading-template></app-loading-template>
</ng-template>
